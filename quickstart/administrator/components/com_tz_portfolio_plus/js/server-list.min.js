!function(t){"use strict";t.tppServerList=function(e,i){var a=t(e),o=t.extend(!0,t.tppServerList.defaults,i),l=function(){var e=a.find(o.pagSelector+" "+o.pagItemSelector);e.length&&e.each(function(){var e=t(this);e.on("click",function(t){t.preventDefault(),t.stopPropagation(),a.find(o.loadingSelector).show(),r(e)})})},r=function(e){var i=o.ajax;i.url=o.url,i.data.view=o.view,void 0!==e&&(i.data.limitstart=e.data("tpp-limitstart")),void 0!==t.fn.tpSerializeObject&&t.extend(i.data,a.find(o.filListSelector).tpSerializeObject()),o.formToken&&(i.data[o.formToken]=1),a.find(o.filterSelector).hide(),i.success=function(e){if(e&&e.data&&e.data.html){var i=a.find(o.listSelector);i.html(e.data.html),a.find(o.pagSelector).html(e.data.pagination),a.find(o.filterSelector).show(),i.find(".modal").on("show.bs.modal",function(){var e=i.find('.action-links [data-toggle=modal][href="#'+t(this).attr("id")+'"]').data("url"),a=t(this).find(".modal-body"),l=t(o.iframeHtml);l.attr("src",e),a.find("iframe").remove(),a.prepend(l)}).on("shown.bs.modal",function(){var e=t(this),i=t(this).find("iframe"),a=(e.outerHeight(!0),e.find("div.modal-header:visible").outerHeight(!0)),o=e.find("div.modal-body:visible").outerHeight(!0),l=e.find("div.modal-body:visible").height(),r=e.find("div.modal-footer:visible").outerHeight(!0),n=e.position().top,d=o-l,s=t(window).height()-2*n-(a+r+d);i.height()>s&&(e.find(".modal-body").css({"max-height":s,"overflow-y":"initial"}),i.css("max-height",s-d))}),l(),n(),a.find(o.loadingSelector).hide()}else a.find(o.errorSelector).show()},i.error=function(){a.find(o.filterSelector).hide(),a.find(o.loadingSelector).hide(),a.find(o.errorSelector).show()},t.ajax(i)};r();var n=function(){a.on("click",o.listSelector+" "+o.installSelector,function(e){e.preventDefault();var i=t(this),a=o.installNow,l=i.attr("href"),r=t(a.loadingHtml);if(!i.hasClass("installing")){i.html(r).addClass("installing");var n=a.ajax;n.url=o.url,n.data.pProduceUrl=l,n.data[o.formToken]=1,n.success=function(t){t.success&&i.addClass("disabled").html(a.installedHtml),t.data.redirect?location.href=t.data.redirect:location.href=o.url+"&view="+o.view+"&layout="+o.layout},t.ajax(n)}})};n()},t.tppServerList.defaults={url:"index.php?option=com_tz_portfolio_plus",view:"addon",layout:"upload",loading:"",iframeHtml:"",formToken:"",filterSelector:".js-stools",filListSelector:"[name^=list]",loadingSelector:"[data-tpp-loading]",errorSelector:"[data-tpp-error]",pagSelector:"[data-tpp-pagination]",pagItemSelector:"[data-tpp-limitstart]",listSelector:"[data-tpp-extension-list]",installSelector:".install-now",ajax:{type:"POST",dataType:"json",data:{format:"ajax",layout:"upload_list_item"}},installNow:{loadingHtml:"",installedHtml:"",ajax:{type:"POST",dataType:"json",data:{task:"addon.ajax_install"}}}},t.fn.tppServerList=function(e){if(void 0===e&&(e={}),"object"==typeof e)return this.each(function(){void 0===t(this).data("tppServerList")?new t.tppServerList(this,e):t(this).data("tppServerList")})}}(jQuery);